<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>asp实现简单网页计数器</title>
        <link media="all" rel="stylesheet" href="../css/reset.css" type="text/css" />
        <link type="text/css" rel="stylesheet" href="../css/text.css" />
        <link rel="stylesheet" href="../css/viki.css">
        
    </head>
    <body>
    <!-- 固定头部 -->
        <iframe src="../header.html" frameborder="0" width="100%" height="55px"></iframe>
    <!-- 内容开始 -->
        <div class="main w1220">
            <br>
            <center style="font-family: 'Microsoft Yahei', sans-serif; font-size: 1.80em; 
                font-weight: normal; color: #FF6600">asp实现简单网页计数器</center>
            <!-- 知识点 -->
            <h3>1、方法一</h3>
            <p>有时我们想在网站中添加一个简单的网页访问计数器，如何实现呢？下面通过<code>asp</code>网页形式实现</p>
            <p>新建一个记事本，重命名为<code>count.txt</code>，输入<code>初始访问统计量1000</code>；</p>
            <p>再新建一个记事本，重命名为<code>count.asp</code>，输入下面代码：</p>
            <xmp><%
set fs=Server.CreateObject("Scripting.FileSystemObject")
File = Server.MapPath("counter.txt")
Set txtr = fs.OpenTextFile(File,1,true)'打开只读文件file，如果不存在则新建
counter=0'将计数器归零
If Not txtr.atEndOfStream Then'先确定还没有到达结尾的位置
Line = txtr.ReadLine '读取一行数据
else
line=0 '否则设置初始值为0
End If
counter=line+1 '计数加1
set txtw = fs.opentextfile(file,2,true) '打开只写文件file
txtw.write counter '写入计数
response.Write("<center>您是第<b>"&counter&"</b>位访客！</center>")
'输出计数
%></xmp>
            <h4>调用方式：</h4>
<p>在网页底部需要显示访问量的位置添加下面代码：</p>
<xmp>共计访问<script language="JavaScript" src="count.asp"></script>次</xmp>
        </div>
        <div id="ft">
            <div id="footer" class="w1220 cl">
                <hr>
                <center style="font-family: 微软雅黑; font-size: small; font-weight: normal; color: #009933">
                        edited by cq&nbsp;©&nbsp;2011-2015&nbsp;1457063@qq.com
                        <br>
                        Generated by <a href="#" target="_blank">sublime</a> 
            </div>
        </div>
    </body>
</html>
